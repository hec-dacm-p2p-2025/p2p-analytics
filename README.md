# p2p-analytics
## Overview

`p2p-analytics` is a Python analysis package built on top of an automated data
pipeline collecting Binance P2P market data and official exchange rates from
the Central Bank of Bolivia (BCB).

The package consumes parquet datasets produced in **Phase 1** of the project
and provides reusable, well-documented functions to analyze:

- BUYâ€“SELL spreads on Binance P2P markets  
- Intraday price behavior  
- Cross-currency comparisons  
- Premium vs official exchange rates  
- Market microstructure indicators (order imbalance, liquidity)  
- Summary statistics and volatility metrics  

The outputs are designed to be directly consumable by downstream tools such as
**Power BI dashboards** (Phase 3).

---

## Repository Structure
```text
p2p-analytics/
â”‚
â”œâ”€ phase2_package/
â”‚ â”œâ”€ pyproject.toml # Package metadata and dependencies
â”‚ â”œâ”€ mkdocs.yml # Documentation configuration
â”‚ â”‚
â”‚ â”œâ”€ src/
â”‚ â”‚ â””â”€ p2p_analytics/
â”‚ â”‚ â”œâ”€ init.py # Public API exports
â”‚ â”‚ â”œâ”€ io.py # Data loader functions
â”‚ â”‚ â”œâ”€ spreads.py # Spread & intraday analytics
â”‚ â”‚ â”œâ”€ premium.py # Official vs P2P premium
â”‚ â”‚ â”œâ”€ microstructure.py # Order imbalance & liquidity
â”‚ â”‚ â””â”€ summary.py # Summary stats & volatility
â”‚ â”‚
â”‚ â”œâ”€ tests/
â”‚ â”‚ â”œâ”€ conftest.py # Shared test fixtures
â”‚ â”‚ â”œâ”€ test_io.py
â”‚ â”‚ â”œâ”€ test_spreads.py
â”‚ â”‚ â””â”€ test_summary.py
â”‚ â”‚
â”‚ â””â”€ docs/
â”‚ â”œâ”€ index.md # Overview page
â”‚ â”œâ”€ installation.md
â”‚ â”œâ”€ get_started.md
â”‚ â”œâ”€ examples.md
â”‚ â””â”€ api/
â”‚ â”œâ”€ io.md
â”‚ â”œâ”€ spreads.md
â”‚ â”œâ”€ premium.md
â”‚ â”œâ”€ microstructure.md
â”‚ â””â”€ summary.md
â”‚
â”œâ”€ README.md
â””â”€ .gitignore
``` 
---

## Installation

Clone the repository and install the package in **editable mode**:

```bash
git clone https://github.com/hec-dacm-p2p-2025/p2p_analytics.git
cd p2p-analytics/phase2_package

python -m venv .venv
.\.venv\Scripts\activate     # Windows
source .venv/bin/activate    # macOS / Linux

pip install -e ".[dev]"
```

## Data Dependenciy
This package does not scrape data itself.

It expects the parquet datasets generated by the Phase 1 data pipeline to
be present locally.

The scraped data may be found in the following repository: `https://github.com/hec-dacm-p2p-2025/final-project.git`

## Core Functions

### Data loaders (`io.py`)
 - `load_binance_currency(currency)`

 - `load_binance_master()`

 - `load_binance_daily(date)`

 - `load_bcb_master()`

These functions isolate I/O logic and keep analytics fast and modular.

### Spread and Price Analysis (`spreads.py`)
 - `p2p_spread(currency, by="day" | "hour")`
Compute absolute and percentage BUYâ€“SELL spreads.

 - `intraday_profile(currency)`
Average hourly price patterns.

 - `fiat_comparison(currencies)`
Cross-currency spread and price comparison.

### Official Premium (`premium.py`)
 - `official_premium(currency, by="day")`
Compare Binance P2P mid-prices to official exchange rates.

### Microstructure (`microstructure.py`)
 - `order_imbalance(currency, by="hour")`
Measure BUY vs SELL depth imbalance.

### Summary and Volatility (`summary.py`)
 - `p2p_summary(currency | currencies, by="day" | "hour")`
Market summary including min/max prices, spreads, and changes vs previous
period.

 - `top_advertisers(currency, metric="volume" | "ads", n=10)`
Rank merchants by activity or liquidity.

 - `price_volatility(currency, by="day", window=7)`
Rolling volatility of mid-prices.

## Example Usage
```python
from p2p_analytics import p2p_spread, official_premium

spread_ars = p2p_spread("ARS", by="day")
premium_ars = official_premium("ARS")

# Export for Power BI
spread_ars.to_parquet("exports/spread_ARS.parquet", index=False)
```

## Documentation
The full documentation is available at:

ðŸ‘‰ `https://hec-dacm-p2p-2025.github.io/p2p-analytics`

## Testing
Run the test suite with `pytest`:

```bash
pytest -q
```

All core functions are covered by lightweight unit tests using mocked data.